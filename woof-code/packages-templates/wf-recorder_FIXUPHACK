cat << EOF > usr/bin/wf-recorder-shell
#!/bin/sh

GEOM=""
if command -v slurp > /dev/null; then
	yad --title="Screen Recorder" --window-icon=media-record-symbolic --button="Whole screen"\!edit-select-all-symbolic:2 --button="Select region"\!edit-select-symbolic:3
	STYLE=\$?
	[ \$STYLE -eq 2 -o \$STYLE -eq 3 ] || exit
	[ \$STYLE -eq 3 ] && GEOM="\`slurp\`"
fi

DST=\`yad --title="Screen Recorder" --window-icon=media-record-symbolic --file --save --confirm-overwrite --filename=recording.mkv\`
[ -z "\$DST" ] && exit

if [ -z "\$GEOM" ]; then
	wf-recorder -f "\$DST" &
else
	wf-recorder -f "\$DST" -g "\$GEOM" &
fi
PID=\$!

yad --layer=overlay --edge=bottomright --button="Stop recording"\!gtk-stop
kill -INT \$PID
EOF
chmod 755 usr/bin/wf-recorder-shell

cat << EOF > usr/share/applications/wf-recorder-shell.desktop
[Desktop Entry]
Encoding=UTF-8
Name=Screen Recorder
Icon=media-record-symbolic
Comment=Capture screen to video
Exec=wf-recorder-shell
Terminal=false
Type=Application
Categories=Video;Recorder;
EOF
chmod 644 usr/share/applications/wf-recorder-shell.desktop
